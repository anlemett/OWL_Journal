import warnings
warnings.filterwarnings('ignore')

import time
import os
import numpy as np
import matplotlib.pyplot as plt
import csv

DATA_DIR = os.path.join("..", "..")
DATA_DIR = os.path.join(DATA_DIR, "Data")
ML_DIR = os.path.join(DATA_DIR, "MLInput")
FIG_DIR = os.path.join(".", "Figures")

RANDOM_STATE = 0
PLOT = False

CHS = True
BINARY = True

#MODEL = "SVC"
MODEL = "KNN"

N_ITER = 100
N_SPLIT = 10
SCORING = 'f1_macro'
#SCORING = 'accuracy'

#TIME_INTERVAL_DURATION = 300
TIME_INTERVAL_DURATION = 180
#TIME_INTERVAL_DURATION = 60
#TIME_INTERVAL_DURATION = 30
#TIME_INTERVAL_DURATION = 10
#TIME_INTERVAL_DURATION = 1

SAVE_COORD = True

def find_elbow_point(x, y):
    # Create a line between the first and last point
    line = np.array([x, y])
    point1 = line[:, 0]
    point2 = line[:, -1]

    # Calculate the distances
    #print("point1:", point1)
    #print("point2:", point2)
    #print("line:", line)
    distances = np.cross(point2-point1, point1-line.T)/np.linalg.norm(point2-point1)
    elbow_index = np.argmax(np.abs(distances))

    #return x[elbow_index]
    return elbow_index


##############
def main():
    
    #no_min_max
    if MODEL == "SVC":
        if BINARY:
            bal_accuracies = [0.8003635642517187, 0.8095571126388155, 0.8095571126388155, 0.8003635642517187, 0.8003635642517187, 0.817944209413009, 0.817944209413009, 0.8195571126388155, 0.8103635642517186, 0.8103635642517186, 0.8087506610259123, 0.8095571126388155, 0.7987506610259123, 0.7995571126388155, 0.7995571126388155, 0.7995571126388155, 0.7903635642517187, 0.7903635642517187, 0.7795571126388154, 0.7787506610259123, 0.7787506610259123, 0.7695571126388154, 0.7895571126388156, 0.7903635642517187, 0.7887506610259122, 0.7787506610259122, 0.7803635642517186, 0.7571377578001057, 0.7579574299312533, 0.7655380750925437, 0.7530380750925436, 0.7671509783183501, 0.7664119513484928, 0.7466671073506082, 0.7317345319936541, 0.7364529349550502, 0.7274881015335801, 0.7233751983077736, 0.6948810153358012, 0.6930407191961925, 0.7214013749338972, 0.6268733474352194]
            f1_scores = [0.807512772785218, 0.8097028504839798, 0.8097028504839798, 0.8066102383933054, 0.8066102383933054, 0.8095155329621603, 0.8095155329621603, 0.8170149349218064, 0.8151278956984036, 0.8151278956984036, 0.8068017144248811, 0.8105548798253877, 0.7988398276431147, 0.802889251861697, 0.8040121902486008, 0.8043153779080434, 0.8023587441001785, 0.8009722356069908, 0.7882466995587838, 0.7850926553913268, 0.7850926553913268, 0.7792267674916776, 0.7975221005095147, 0.8012683370686544, 0.7945312265052278, 0.7852558255544969, 0.791952314071529, 0.7592925054100743, 0.7622122274137462, 0.7615347493674658, 0.7513231596587594, 0.7685137553574861, 0.7563473301460777, 0.7190648062944581, 0.6995317375162029, 0.6750627791667287, 0.6539615024670254, 0.6507857703804295, 0.6038878939693145, 0.5860841225457292, 0.5643652823358053, 0.5099354822881293]
        else:
            bal_accuracies = [0.7531107998755058, 0.7624406058719785, 0.7543894594874987, 0.7543894594874987, 0.7639573607220667, 0.7651919286233013, 0.7585252619566345, 0.7575007780890134, 0.756266210187779, 0.758409067330636, 0.7508180309160701, 0.7498215582529308, 0.7498215582529308, 0.7508019504097936, 0.7495673825085589, 0.7668544454818965, 0.7615442473285611, 0.7665105301379811, 0.7649496835771346, 0.7652038593215064, 0.7580490714804441, 0.7590735553480652, 0.7503657018362901, 0.7570925407199918, 0.7717885672787633, 0.769407614897811, 0.7510576823321922, 0.742962444236954, 0.7354372860255213, 0.7369260296711276, 0.7693853096794274, 0.7755358439672165, 0.7642509596431165, 0.7817558875402012, 0.7564539890030085, 0.6740937856624132, 0.695592385102189, 0.689839713663243, 0.7150497976968564, 0.6351504305425875, 0.5888790330947195, 0.5115442473285611]
            f1_scores = [0.756829351289646, 0.7627062224724975, 0.7580557142943029, 0.7580046208075742, 0.7640483006913682, 0.7651560545580136, 0.7591701390650558, 0.7580610283799698, 0.7569532745133245, 0.7590892687816932, 0.7550881240690376, 0.7526113161399204, 0.7525942727812523, 0.7550275795146055, 0.7543856288726549, 0.7725497540110734, 0.7682177095282066, 0.7772821827480199, 0.7735181512263052, 0.7713880460058495, 0.7646010073745093, 0.7659700444445365, 0.7530804505177484, 0.7559723743775261, 0.7713753721530179, 0.7674961401285463, 0.7538942354775429, 0.7437163742323996, 0.741015186284973, 0.7441899078228185, 0.7810343845397254, 0.7732059051971827, 0.7560923754330897, 0.7628092750028521, 0.7448886864113131, 0.6515273464233797, 0.6616374720248828, 0.6552227815269609, 0.669833147633, 0.5719856400055668, 0.5051273962979723, 0.442750501751882]
    elif MODEL == "KNN":
        if BINARY:
            bal_accuracies = [0.8210351665785298, 0.7828635642517188, 0.8353093601269169, 0.846102591221576, 0.796909042834479, 0.8210219460602856, 0.821841618191433, 0.8161025912215759, 0.8352961396086727, 0.8169090428344792, 0.7828767847699629, 0.7977829190904284, 0.7953635642517187, 0.8294896879957694, 0.8602287149656267, 0.798602591221576, 0.808602591221576, 0.8094222633527235, 0.8110351665785298, 0.8160219460602857, 0.8285219460602857, 0.8044764674775251, 0.8252154944473824, 0.803602591221576, 0.8127961396086727, 0.8152154944473825, 0.7819764674775251, 0.7827829190904283, 0.7884545214172395, 0.7936025912215758, 0.799341618191433, 0.7976480698043364, 0.7993283976731888, 0.7985351665785299, 0.8342609730301428, 0.8334545214172395, 0.7776480698043363, 0.7468958223162347, 0.6886964569011106, 0.6111964569011105, 0.5770967741935483, 0.5620029085140137]
            f1_scores = [0.8485293969524761, 0.7947488479664662, 0.8420796708000194, 0.8546002847976316, 0.8217970869160643, 0.843711812910119, 0.8471727857603322, 0.8307931035684586, 0.8431308646072019, 0.8374776611565464, 0.7895931343829741, 0.809742312193495, 0.7980853241950436, 0.826295328452796, 0.8702823579482232, 0.8176864181251957, 0.8270091524981904, 0.8307623178986969, 0.837561693386597, 0.8444180209178185, 0.8519608780606756, 0.8156840143796067, 0.8448227697663124, 0.8173971894889822, 0.8247297434847617, 0.8361021348456775, 0.8004226729789397, 0.803432978538973, 0.8300428954577399, 0.8163917815310162, 0.831035235357066, 0.8325431674144944, 0.8258456614738012, 0.8231933787873768, 0.870204467282767, 0.8642424076621706, 0.8126800625208622, 0.7732113986058673, 0.7196422654153382, 0.6345097659667542, 0.5960526078141443, 0.5698331858448967]
        else:
            bal_accuracies = [0.7512599854756717, 0.7764041913061521, 0.7790512501296816, 0.7657739392053118, 0.7626667704118686, 0.7670245876128228, 0.7746877269426289, 0.7740455441435834, 0.7688650274924785, 0.7488748832866481, 0.7710400456478889, 0.7541850814399835, 0.7681548915862642, 0.7483105093889407, 0.7519483348895113, 0.7454357298474946, 0.7477004876024484, 0.7433208839091192, 0.7562999273783588, 0.7371184770204378, 0.7449315281668222, 0.756604419545596, 0.7381927585849154, 0.7475666562921465, 0.7605441435833592, 0.7584012864405021, 0.7691093474426808, 0.721224193381056, 0.7244195455960161, 0.7356100217864924, 0.7229131652661065, 0.6873544973544974, 0.655965867828613, 0.6703558460421205, 0.6504554414358337, 0.6404730781201369, 0.6054305425874054, 0.5884578275754746, 0.5706478887851437, 0.5543230625583566, 0.45449994812739913, 0.4056395891690009]
            f1_scores = [0.7558872954318814, 0.7858951987219956, 0.7870412967331748, 0.7786242286859438, 0.7700708534880913, 0.7790605331274643, 0.7874666230407239, 0.786282103103183, 0.7755239739348102, 0.7656627468860779, 0.7827257120266242, 0.7687409312905873, 0.7850947886618905, 0.7581460609135542, 0.756947764502499, 0.7522204896715153, 0.7511594910898938, 0.7544032611368301, 0.7624791342428273, 0.7536319581224035, 0.7654267595392056, 0.7722198746224496, 0.7434944545241261, 0.7525262744576965, 0.765553733525691, 0.7656679169196848, 0.7598370763604169, 0.7178642482558499, 0.7368098214759472, 0.7417844189108374, 0.7322647045136109, 0.6897974276622805, 0.6670575447007228, 0.6819768402777987, 0.6616952272454955, 0.6515558159886679, 0.6239069935792468, 0.6013591539258271, 0.5852763554893193, 0.5683205446278994, 0.45930730092336647, 0.3976269887953673]
    
    '''
    #no_min_max_no_head
    if MODEL == "SVC":
        if BINARY:
            bal_accuracies = [0.8250277630883132, 0.8258342147012163, 0.826653886832364, 0.8274735589635114, 0.8274735589635114, 0.8274735589635114, 0.8174735589635114, 0.8174735589635114, 0.8066671073506082, 0.7974735589635114, 0.7990864621893179, 0.7990732416710735, 0.7998664727657324, 0.7806729243786357, 0.7890600211528292, 0.7798664727657324, 0.7782403490216817, 0.7757945531464834, 0.7898664727657325, 0.7774206768905341, 0.7814529349550503, 0.7866142252776308, 0.7974338974087785, 0.795027763088313, 0.7966406663141196, 0.7760629296668429, 0.7628239026969859, 0.7820306716023268, 0.7737109994711793, 0.6915481226864093, 0.7012400846113168, 0.6507297726070862, 0.5961237440507668]
            f1_scores = [0.7731162139925705, 0.7758154373335372, 0.7788137135671075, 0.7822710138425897, 0.7836212147202054, 0.7836212147202054, 0.7768579035157616, 0.7768579035157616, 0.7640878443765442, 0.7556915796535189, 0.7609549526441646, 0.7614260339721758, 0.7640669189193201, 0.753353218167801, 0.7553731745480284, 0.7503623441635141, 0.7455815976029813, 0.7383976544805917, 0.7587134865282199, 0.7443483102273263, 0.7592149067449359, 0.7512513419107761, 0.7589431816924221, 0.7434179563266651, 0.7491154419011998, 0.7185253049936471, 0.7011897001713732, 0.712312054428355, 0.7090176010423918, 0.6036252036780031, 0.5624083516949032, 0.532061753363039, 0.43245524838787974]
        else:
            bal_accuracies = [0.7425495383338521, 0.7449304907148044, 0.7461650586160391, 0.7461370474115573, 0.7428638862952589, 0.7428638862952589, 0.7499948127399108, 0.7421376698827679, 0.7443085382301069, 0.7386383442265795, 0.7445627139744786, 0.7417615935262993, 0.7350669156551509, 0.7443308434484905, 0.7332342566656292, 0.7240984541964934, 0.7354933084344848, 0.7278462496109555, 0.7374317875298267, 0.7310473078120138, 0.7334163294947608, 0.7316614794065774, 0.7218196908392986, 0.7072134038800705, 0.7030195040979355, 0.724940346508974, 0.7203122730573712, 0.7201602863367569, 0.7314726631393298, 0.680785869903517, 0.6408942836393817, 0.5693853096794274, 0.5234547152194211]
            f1_scores = [0.7208798947211287, 0.7245346359375591, 0.7257616579813054, 0.7256991491319327, 0.727348089219115, 0.727348089219115, 0.7368666018687425, 0.7284356522836736, 0.7319318805199517, 0.7269696765643501, 0.7311570151645445, 0.7344245894059286, 0.7269771672316352, 0.7403019398808398, 0.7275598681791091, 0.7215701132866019, 0.7307127863067779, 0.7261338778827755, 0.7281520331536508, 0.7226161461964398, 0.7262651558651594, 0.7229692619249563, 0.7142591714629929, 0.6937902333458339, 0.6811115515843479, 0.6957095760708433, 0.6949362092442453, 0.6804458356417685, 0.6950485282621394, 0.6348121147199447, 0.6033602149086039, 0.507627792961629, 0.47824459280726395]
    elif MODEL == "KNN":
        if BINARY:
            bal_accuracies = [0.7920571126388154, 0.7828503437334743, 0.7744764674775251, 0.7645703331570598, 0.7937638815441564, 0.7921377578001059, 0.7604309888947647, 0.7880248545742994, 0.7744764674775251, 0.7720571126388155, 0.7937506610259122, 0.7446377578001057, 0.7288987308302486, 0.7622184029613961, 0.8121509783183501, 0.8113445267054468, 0.8286832363828662, 0.8194896879957694, 0.819476467477525, 0.8294896879957694, 0.8236832363828661, 0.8353635642517186, 0.8245703331570597, 0.8337506610259122, 0.8112771020624008, 0.8337638815441565, 0.7695029085140138, 0.7570029085140138, 0.6829442094130089, 0.610376784769963, 0.6319896879957694, 0.5730380750925437, 0.5038709677419355]
            f1_scores = [0.7966056397285934, 0.7964596054364795, 0.7904028010986581, 0.76648459716226, 0.793133398095347, 0.7868595543094171, 0.7643697677453638, 0.7789995361130616, 0.7901655424776074, 0.776263029345304, 0.7913891944631246, 0.748126125545481, 0.7219191649425791, 0.7572654543950128, 0.807244740529175, 0.7986808136752025, 0.82878654645333, 0.8219283461778311, 0.821610781388231, 0.8281252929972578, 0.8261314094187725, 0.8322337545168097, 0.8200780316500687, 0.8236437014860304, 0.8057119917977975, 0.8180499546242725, 0.7817838623353595, 0.7721269200952893, 0.7008778789265813, 0.6152234293709947, 0.6468860887096775, 0.5680863154984712, 0.49384327132999506]
        else:
            bal_accuracies = [0.7382643427741468, 0.7188842203548086, 0.721531279178338, 0.7089838157485215, 0.7081875713248262, 0.7073555348065151, 0.7030796763149704, 0.7097982155825292, 0.7089558045440397, 0.6965930075733997, 0.7150025936300446, 0.66425407199917, 0.659007677144932, 0.6497660545699762, 0.6894501504305426, 0.6848122211847703, 0.7006027596223674, 0.6948983297022513, 0.6996545284780578, 0.6902043780475152, 0.6932316630355846, 0.6994221392260609, 0.69974011826953, 0.6726351281253242, 0.6883520074696545, 0.6688505031642287, 0.650439360929557, 0.6455628177196804, 0.617357090984542, 0.5299937752878929, 0.5109031019815333, 0.4437244527440606, 0.4056395891690009]
            f1_scores = [0.747959778555004, 0.7223695345807845, 0.7252885146733006, 0.7041416769400342, 0.7092286537976189, 0.7119139143121165, 0.7083206544541258, 0.7157643242128254, 0.7164480971642039, 0.7001989386528014, 0.7178753295250053, 0.6619541875814592, 0.6570991995497424, 0.653368072877444, 0.7035844230124478, 0.6963307944703467, 0.7190104610070568, 0.7119585726110856, 0.7073910075614108, 0.6878624345944269, 0.6874973018635581, 0.7013168106521787, 0.7015147609747138, 0.6775791201887246, 0.6926145509564965, 0.6796136537745332, 0.6682215482873892, 0.659844895723319, 0.6288978925936333, 0.5361391280847447, 0.5270977048451996, 0.43798068816218205, 0.3976269887953673]
    '''
    '''
    #left_right_no_min_max, orig.
    if MODEL == "SVC":
        if BINARY:
            bal_accuracies = [0.8037916446324695, 0.8054177683765203, 0.8037916446324698, 0.8171113167636171, 0.8179177683765204, 0.8195306716023267, 0.8203239026969857, 0.8203239026969857, 0.8195174510840826, 0.8251758328926494, 0.816062929666843, 0.8368693812797462, 0.8384822845055527, 0.8517080909571655, 0.830095187731359, 0.8144500264410365, 0.7970848757271285, 0.7900555261766262, 0.7919381279746166, 0.7755803807509255, 0.7340362242199895, 0.6362414066631412]
            f1_scores = [0.6753749123114619, 0.6801711413386665, 0.6765076279106965, 0.6834267777773354, 0.6849932855190675, 0.6887781937053099, 0.6897055270912892, 0.6897055270912892, 0.6877496042262755, 0.7013871678378344, 0.691390417661214, 0.7032331018479383, 0.7080359688569033, 0.7211681722596585, 0.70640000567857, 0.6875352504631282, 0.669281185888576, 0.6435560818459664, 0.6373380533270634, 0.6169894650006523, 0.5681246152122907, 0.4699727453196811]
        else:
            bal_accuracies = [0.6851187882560432, 0.6898246706089843, 0.6919675277518416, 0.695627139744787, 0.6997748729121278, 0.6985403050108933, 0.7003392468098351, 0.7113637306774561, 0.7064415395787944, 0.7024821039526923, 0.7053257599336031, 0.699567382508559, 0.6908916900093371, 0.7103657018362901, 0.69397499740637, 0.684801327938583, 0.6862298993671544, 0.661683784624961, 0.6726605456997613, 0.6406733063595808, 0.5765416536985165, 0.44144361448283015]
            f1_scores = [0.6357432678599195, 0.6379817152674508, 0.6405071888346248, 0.6452057160213351, 0.6501551401972467, 0.6475636774915818, 0.6535500866919253, 0.6677458280021881, 0.6602940842688312, 0.6611649097190215, 0.6662447156221564, 0.662727568594675, 0.6530084418971553, 0.6675549798587628, 0.6540648954379737, 0.6490950084714544, 0.6383996415950128, 0.6329216737702827, 0.625104489193079, 0.5944651654999644, 0.5169283277689924, 0.3601065226076938]
    elif MODEL == "KNN":
        if BINARY:
            bal_accuracies = [0.7538180856689582, 0.7638180856689583, 0.785444209413009, 0.7762506610259123, 0.765444209413009, 0.7578635642517187, 0.7295029085140138, 0.7545029085140138, 0.7536158117398203, 0.7645029085140138, 0.795309360126917, 0.7761158117398202, 0.7645029085140138, 0.7412771020624008, 0.7371641988365945, 0.6978900052882073, 0.7403900052882074, 0.6781319407720783, 0.6213445267054467, 0.6081319407720782, 0.6396509783183502, 0.5115058170280276]
            #f1_scores = [0.7530528382212958, 0.7559945827300276, 0.7922279223644614, 0.7858994640964163, 0.7747500398778339, 0.7743375011225975, 0.7437915942374496, 0.7623614079515809, 0.7818035162491894, 0.7768906075558293, 0.8177201718290451, 0.7985221981488557, 0.7724958018962221, 0.7474804989647661, 0.7277253608226874, 0.7097167948432302, 0.7483288986775255, 0.6781408802198727, 0.6304999545163208, 0.5993092139413687, 0.6485710532716855, 0.5018119280928925]
            f1_scores = [0.7530528382212958, 0.7559945827300276, 0.7922279223644614, 0.7858994640964163, 0.7747500398778339, 0.7743375011225975, 0.7437915942374496, 0.7623614079515809, 0.7818035162491894, 0.7768906075558293, 0.8177201718290451, 0.7985221981488557, 0.7724958018962221, 0.7474804989647661, 0.7277253608226874, 0.7097167948432302, 0.7483288986775255, 0.6781408802198727, 0.6304999545163208, 0.5993092139413687, 0.6485710532716855, 0.5018119280928925]

        else:
            bal_accuracies = [0.6554782653802262, 0.633063595808694, 0.6692379914928935, 0.6690139018570391, 0.6917050523913268, 0.7042582218072415, 0.7058667911609089, 0.6941881937960369, 0.6957609710550888, 0.6945222533457829, 0.700066396929142, 0.6814171594563752, 0.6636539060068473, 0.6740621433758689, 0.6517491441020853, 0.6588743645606392, 0.6707246602344642, 0.6109300757339973, 0.6306764187156344, 0.5821708683473389, 0.5045217346197738, 0.39995538956323273]
            f1_scores = [0.6625831429951743, 0.6443525435127068, 0.6775484206276015, 0.6820759065003252, 0.6999205228445169, 0.7111671203924678, 0.7086906142341739, 0.6998944788357238, 0.7036991684062225, 0.7011337879401129, 0.7162664920255923, 0.6961203876373062, 0.6730397073669613, 0.6889210642880743, 0.6720517738811583, 0.6778817930908395, 0.6827786120675295, 0.6209499676902808, 0.6312239262429563, 0.5829723963717128, 0.5173995994395598, 0.392454000717998]
    '''
    '''
    #init_blinks_no_min_max, left/right average and diff.
    if MODEL == "SVC":
        if BINARY:
            bal_accuracies = []
            f1_scores = []
        else:
            bal_accuracies = []
            f1_scores = []
    elif MODEL == "KNN":
        if BINARY:
            bal_accuracies = [0.7620161290322581, 0.7636290322580646, 0.7528225806451614, 0.7612096774193549, 0.7877419354838711, 0.7620029085140138, 0.7820029085140139, 0.7686964569011105, 0.8036158117398202, 0.770376784769963, 0.7627829190904283, 0.8277287149656267, 0.8161025912215759, 0.7652022739291381, 0.7652022739291381, 0.7744896879957694, 0.7827961396086727, 0.7761025912215759, 0.7877961396086727, 0.7844896879957695, 0.7944896879957695, 0.8002154944473823, 0.7777154944473823, 0.7886025912215759, 0.7761025912215759, 0.7619896879957695, 0.8186158117398202, 0.805309360126917, 0.8269896879957696, 0.8061158117398202, 0.7861158117398203, 0.7852961396086726, 0.775309360126917, 0.7744354838709678, 0.7752419354838709, 0.7744354838709677, 0.7776480698043364, 0.7352287149656267, 0.7387096774193549, 0.7311025912215758, 0.6370703331570597, 0.5571377578001058]
            f1_scores = [0.7785470740092665, 0.7863732463587204, 0.77646932913773, 0.7767373678795018, 0.80827703789894, 0.781569987627767, 0.7955649330537974, 0.7803321676677564, 0.8228432868915926, 0.784938967876266, 0.7912137805685446, 0.8518567119816878, 0.8345864767300704, 0.8013808717723082, 0.8013808717723082, 0.7937420631490397, 0.8021072581768361, 0.801979481214444, 0.8079274209463418, 0.8030051357134351, 0.8098333348178179, 0.8279723274691397, 0.8139646433490096, 0.8125534298313445, 0.8038809805370782, 0.7836664900096844, 0.8369896448583166, 0.8171927100413023, 0.8338257657566308, 0.8280941038526637, 0.8063716109005794, 0.8059829740041764, 0.7927132034368318, 0.8081731306546412, 0.8078726445616825, 0.8026962182146585, 0.8150613125964575, 0.7725416880677068, 0.7566153182071753, 0.7536132752307934, 0.6576649481130457, 0.5599970819927867]
        else:
            bal_accuracies = []
            f1_scores = []
    '''
    '''
    #left_right_average_no_min_max, left_right_diff_no_min_max
    if MODEL == "SVC":
        if BINARY:
            bal_accuracies = [0.767258064516129, 0.7712903225806451, 0.7729032258064515, 0.7745161290322581, 0.7685483870967742, 0.7793548387096775, 0.7693548387096774, 0.771774193548387, 0.7725806451612903, 0.7801612903225805, 0.8017609730301428, 0.7993416181914331, 0.79853516657853, 0.7904309888947647, 0.8032271285034375, 0.7875687466948704, 0.80352326811211, 0.7858619777895294, 0.786225542041248, 0.7369526705446854, 0.7169658910629296, 0.6103807509254363]
            f1_scores = [0.6996750614108102, 0.7089651849425763, 0.7136618344774144, 0.7179591496609026, 0.71675880369375, 0.7322624725786784, 0.7188588207470403, 0.7272048193029976, 0.7296857735324659, 0.7254001585283596, 0.7495561726108495, 0.7388667556845802, 0.7381214274281479, 0.7167808380970625, 0.7102618869788062, 0.6885437972780178, 0.6928385858064059, 0.6450885982297271, 0.6317179321322846, 0.5818961614525973, 0.5744206864532746, 0.5234919405706158]
        else:
            bal_accuracies = [0.7107464467268388, 0.704826226787011, 0.7053423591658885, 0.7037975931113186, 0.7161126672891379, 0.7177954144620812, 0.7168430335097002, 0.7244060587197843, 0.7361328976034858, 0.7213388318290279, 0.7096042120551924, 0.7197925095964312, 0.7097925095964311, 0.7223487913683992, 0.7025267143894596, 0.6796311858076566, 0.680885984023239, 0.6322917315074178, 0.6655612615416537, 0.6704995331465919, 0.6034599024795103, 0.4192151675485009]
            f1_scores = [0.6915033976486183, 0.6878232632519566, 0.6871100460708703, 0.6827143333328075, 0.6974262861585949, 0.7033248251239539, 0.7004942359179177, 0.703379119531448, 0.7126819029891448, 0.7017611793563912, 0.6899706250582984, 0.706398854029048, 0.6972805312961259, 0.6983535317970044, 0.6713380518369594, 0.6515740755800644, 0.6476295805007883, 0.5943172626174369, 0.5999945408547303, 0.6029719564754716, 0.5266280904841565, 0.41603482077147425]
    elif MODEL == "KNN":
        if BINARY:
            bal_accuracies = [0.762741935483871, 0.7527419354838709, 0.7603225806451612, 0.7119354838709678, 0.752016129032258, 0.7728225806451613, 0.7628225806451612, 0.7944354838709677, 0.7936290322580646, 0.785241935483871, 0.7960483870967742, 0.7511290322580645, 0.8011290322580644, 0.7411290322580645, 0.7771774193548387, 0.7145967741935484, 0.7971774193548387, 0.7111290322580646, 0.6372051824431517, 0.6797184029613961, 0.6472448439978848, 0.529825489159175]
            f1_scores = [0.7865843850229985, 0.7777382032957145, 0.7758153592590082, 0.7377802226918478, 0.7569641720694178, 0.7773308387360844, 0.7690732482030461, 0.8139874099234842, 0.809035451312989, 0.8068480092694541, 0.8221657293498806, 0.7727331888519553, 0.8204146049684209, 0.7654988602891585, 0.7690801543930116, 0.7290103032727447, 0.7927673324419331, 0.7323622776991587, 0.6502785436963535, 0.6836770568100714, 0.662180551068553, 0.5260402392001702]
        else:
            bal_accuracies = [0.6785755783795, 0.7088520593422554, 0.6662765847079573, 0.6749361967009027, 0.6719467787114846, 0.67534650897396, 0.6961826953003423, 0.6857625272331155, 0.7014830376595083, 0.6990123456790124, 0.7043427741466957, 0.7140403568834941, 0.7286466438427223, 0.7034261852889305, 0.6912848843241, 0.684934121796867, 0.7013009648303765, 0.6888520593422554, 0.691638655462185, 0.6265681087249715, 0.4712174499429402, 0.43572673513849985]
            f1_scores = [0.6894272825118043, 0.7168749211935808, 0.6772124868938504, 0.6838143269186193, 0.6814738529555481, 0.6890409637658391, 0.7022751857081546, 0.6965720602447161, 0.7115788640852039, 0.7126650814124287, 0.7211838561748337, 0.7299321466895098, 0.7420990533273757, 0.7128356546796003, 0.7010254739041577, 0.7005638361416509, 0.7159646152222722, 0.7114775804728162, 0.7010893453185578, 0.6148657922776379, 0.468642919096048, 0.4397569107967043]
    '''

    '''
    #left_right_no_min_max, left/right orig. + left/right diff.
    if MODEL == "SVC":
        if BINARY:
            bal_accuracies = [0.7836964569011106, 0.7836964569011106, 0.7736964569011107, 0.7845029085140138, 0.7845029085140138, 0.7745029085140138, 0.7736964569011106, 0.7736964569011104, 0.7761158117398202, 0.7777287149656267, 0.7785483870967742, 0.7701612903225806, 0.771774193548387, 0.7809677419354839, 0.7825806451612902, 0.7833870967741935, 0.7841803278688524, 0.8041935483870967, 0.7941935483870968, 0.7941935483870968, 0.8001480698043363, 0.8109545214172396, 0.810134849286092, 0.8077287149656266, 0.812043892120571, 0.8056597038603913, 0.7967622950819673, 0.805955843469064, 0.8107813326282389, 0.7934029613960867, 0.7426507139079852, 0.743216552088842, 0.6103807509254363]
            f1_scores = [0.7206021964231386, 0.7208447324770445, 0.7154351995738667, 0.723013763259164, 0.723013763259164, 0.7164993503228209, 0.7141534119474706, 0.7138859124325793, 0.7200840724917692, 0.725250978433143, 0.7292353102303781, 0.7217898929236706, 0.7277837347110723, 0.7290127062331313, 0.7432500481955675, 0.7383363146640061, 0.7408946228214487, 0.7580853912274127, 0.7465406038607539, 0.7456378545010647, 0.7423161766429383, 0.7528659912704125, 0.7496790073028845, 0.7405545394608772, 0.7371880289454297, 0.7168724094196653, 0.690965279558161, 0.7000599410326391, 0.661950164367949, 0.6481840491737407, 0.5920621153726283, 0.5731643201567753, 0.5234919405706158]
        else:
            bal_accuracies = [0.7155524431995021, 0.7167870111007366, 0.7155244319950202, 0.7167309886917731, 0.7147982155825294, 0.7170131756406267, 0.7174732856105406, 0.7251805166511048, 0.7252246083618633, 0.7262330117232078, 0.7232155825293081, 0.7248044402946363, 0.7263492063492063, 0.7225236020334059, 0.7224514991181658, 0.723375868866065, 0.7138198983297022, 0.7228675173773214, 0.718375868866065, 0.7311951447245566, 0.7177554725593941, 0.7185434173669468, 0.7177113808486358, 0.7189179375453886, 0.7207422969187676, 0.6916702977487292, 0.7071848739495799, 0.701632430750078, 0.6914825189334993, 0.6801317564062662, 0.6749164851125635, 0.5549693951654737, 0.42034910260400454]
            f1_scores = [0.6962822637668553, 0.6983948425461008, 0.6976464173921622, 0.7014404477309834, 0.6992760881996676, 0.6999357121427278, 0.6975477701252965, 0.7121719246724669, 0.7114959610575462, 0.7137635633837113, 0.7108809516402835, 0.7124756482195395, 0.7154846797829889, 0.7143898151340651, 0.7129495649729691, 0.7124975578973481, 0.7028729616509723, 0.7078920017898912, 0.7058195801315806, 0.7187866636948776, 0.7050404149812801, 0.7025957920401852, 0.699863552434555, 0.7040180308898825, 0.7071580392788319, 0.6621069080330071, 0.6770004142810859, 0.6640968892040628, 0.6577337814190976, 0.6385262920880004, 0.607311509391019, 0.5077883621919438, 0.353026293177344]
    elif MODEL == "KNN":
        if BINARY:
            bal_accuracies = [0.740241935483871, 0.742741935483871, 0.7210483870967743, 0.7494354838709678, 0.7361964569011106, 0.7261964569011106, 0.7370029085140138, 0.7453900052882074, 0.7361964569011106, 0.7494896879957695, 0.7386832363828661, 0.7562771020624008, 0.757876784769963, 0.7578767847699629, 0.7578767847699629, 0.7711964569011107, 0.7620029085140139, 0.7720029085140137, 0.7836158117398202, 0.7744222633527235, 0.8028767847699629, 0.8144896879957695, 0.7861290322580646, 0.8069354838709677, 0.7860483870967742, 0.7619354838709678, 0.7353225806451613, 0.7245703331570598, 0.6680645161290324, 0.6171641988365943, 0.6855380750925436, 0.5904706504494976, 0.5636025912215759]
            f1_scores = [0.7615043502758877, 0.772596663736705, 0.7547486040051445, 0.7727246217676049, 0.7471389415231082, 0.7378229185259828, 0.7518573366531524, 0.7559894279542398, 0.7490703803351921, 0.7679132645328965, 0.7585399126847887, 0.7584929506192889, 0.7648438994060919, 0.7648371880302224, 0.7648371880302224, 0.7785472813200952, 0.7778773836062094, 0.7852613532339241, 0.8022361481653674, 0.8000588480199318, 0.8100796312087247, 0.8279530092512608, 0.8129222345972936, 0.8318428882005824, 0.8215310840177235, 0.7901689744427108, 0.7548184584383384, 0.7427724555843509, 0.6701869910603296, 0.6282620630028827, 0.6860932329005089, 0.596193498614762, 0.5757709661995551]
        else:
            bal_accuracies = [0.6960006224712108, 0.6883535636476814, 0.6862107065048242, 0.6915432098765433, 0.6837000726216413, 0.6810607946882457, 0.6955607428156447, 0.7087882560431581, 0.6977596223674656, 0.6751701421309264, 0.6638956323270049, 0.6758185496420791, 0.6950643220251063, 0.6790139018570392, 0.6903542898640938, 0.6793681917211329, 0.6684759829857869, 0.7053968253968254, 0.6990860047722793, 0.6959171075837742, 0.7335802469135803, 0.723342670401494, 0.7214757754953834, 0.7296374105197634, 0.7091767818238408, 0.7066754850088184, 0.7001172320780163, 0.6737483141404711, 0.6790621433758689, 0.6144034650897395, 0.5504715219421101, 0.489727150119307, 0.40355379188712515]
            f1_scores = [0.711682445117966, 0.7020228178778164, 0.7036643081549114, 0.7056922931277125, 0.7000346807975284, 0.6962143959385168, 0.7052591529728857, 0.722155230487303, 0.7166053705418007, 0.6977417618711748, 0.681605303102373, 0.7011262931239826, 0.7090247994186882, 0.6978209341456771, 0.6981073954536707, 0.6862716589943325, 0.6902208476366674, 0.7213365198469786, 0.711718772289714, 0.7104537714491485, 0.7466254274990007, 0.7343524551183415, 0.7374438889418593, 0.7373687240621654, 0.7124293741176448, 0.7185587611340316, 0.7136334334368952, 0.6814196683871327, 0.6936156981492289, 0.6199017265129951, 0.5556144665050928, 0.4933616285619025, 0.40501957407719774]
    '''
    
    '''
    #init_blinks_no_min_max, no_head(???), left/right orig. + left/right diff.
    if MODEL == "SVC":
        if BINARY:
            bal_accuracies = []
            f1_scores = []
        else:
            bal_accuracies = []
            f1_scores = []
    elif MODEL == "KNN":
        if BINARY:
            bal_accuracies = [0.7628225806451613, 0.7652419354838711, 0.7494222633527234, 0.7960351665785298, 0.7944222633527234, 0.7936158117398202, 0.7819222633527234, 0.8185483870967742, 0.8161290322580645, 0.8185483870967742, 0.8044222633527234, 0.7744222633527235, 0.7628225806451613, 0.7544354838709677, 0.7536158117398202, 0.7752961396086727, 0.772809360126917, 0.762809360126917, 0.7520161290322581, 0.7728225806451614, 0.7736290322580646, 0.7720161290322582, 0.739516129032258, 0.7712096774193549, 0.7811832363828664, 0.7936964569011107, 0.7611832363828662, 0.770376784769963, 0.7687638815441565, 0.7795835536753041, 0.7711964569011105, 0.7728093601269169, 0.7845161290322582, 0.7628225806451613, 0.781209677419355, 0.7928900052882074, 0.7912771020624009, 0.7671245372818614, 0.777944209413009, 0.770376784769963, 0.7628635642517188, 0.7287903225806451, 0.7647316234796404, 0.7520703331570597, 0.7469354838709676, 0.7571377578001058, 0.7471774193548387, 0.6786290322580645, 0.661048387096774, 0.633079058699101, 0.6452961396086726, 0.6011290322580646, 0.5257932310946589]
            f1_scores = [0.7825298434955023, 0.7919955032400763, 0.7797811031751649, 0.8276628426471367, 0.8175500652318863, 0.8117864707618402, 0.8032339398282069, 0.8465250281569574, 0.8309256741859417, 0.8452466237013985, 0.8269637218493386, 0.8047229426966791, 0.7876830479687287, 0.7887568356374809, 0.7827551459293396, 0.7984272851023442, 0.7983816180235536, 0.7890655950264283, 0.7765590884636667, 0.796396978888654, 0.8003813106858889, 0.7924193510921286, 0.7623752138673462, 0.7873012375071384, 0.7932452910080208, 0.8047838085247212, 0.7793309446627689, 0.7846161469157129, 0.7780191219915673, 0.7910883103891991, 0.7909248731575628, 0.7975218980817085, 0.8041747283151744, 0.7895749694082214, 0.7978956156236159, 0.8038287441438412, 0.7987131900325949, 0.7738245651105029, 0.7845918997499135, 0.7903230361743435, 0.772130756025436, 0.7378151606379716, 0.7550375337186455, 0.7594628107793436, 0.7706033948709303, 0.754402416940439, 0.7462929876029702, 0.6991826601980505, 0.6993823504620063, 0.6341658415397292, 0.6529819303784279, 0.6041920564598603, 0.530301496480347]
        else:
            bal_accuracies = []
            f1_scores = []
    '''
    
    
    '''
    #init_blinks, 64 features
    if MODEL == "SVC":
        if BINARY:
            bal_accuracies = [0.8121377578001058, 0.818079058699101, 0.7920571126388154, 0.800444209413009, 0.7887506610259122, 0.7863313061872026, 0.7796245372818613, 0.7712374405076678, 0.7736567953463775, 0.7896245372818613, 0.7704309888947647, 0.7804309888947646, 0.7519896879957695, 0.7896509783183501, 0.7880380750925436, 0.7672316234796404, 0.7780380750925435, 0.7772316234796404, 0.7588445267054469, 0.7688180856689583, 0.7519896879957695, 0.7669090428344791, 0.7744896879957694, 0.7869222633527234, 0.7861158117398201, 0.7819896879957694, 0.7827961396086727, 0.812876784769963, 0.8045029085140138, 0.7936964569011106, 0.8028900052882072, 0.8312771020624009, 0.8288577472236911, 0.8388445267054468, 0.8280380750925437, 0.8414251718667373, 0.8363445267054468, 0.826425171866737, 0.8272316234796403, 0.8748929138022211, 0.81715097831835, 0.8437638815441565, 0.8437638815441565, 0.8313709677419354, 0.8131054997355897, 0.8098929138022211, 0.816344526705447, 0.8263577472236913, 0.7704032258064516, 0.7747580645161292, 0.7887903225806452, 0.7895967741935486, 0.8195835536753041, 0.7962771020624009, 0.8131319407720783, 0.7890600211528291, 0.7599193548387098, 0.7662903225806452, 0.7674735589635113, 0.7384822845055525, 0.6175277630883129, 0.6119632469592808, 0.6845174510840825, 0.657769698572184]
            f1_scores = [0.7982671334583229, 0.7812004101760797, 0.7939464104412602, 0.7949431810062301, 0.7912239145093911, 0.779265896364531, 0.7728926125178037, 0.7726201805890526, 0.7867166677084905, 0.7795181782665751, 0.7689950550935843, 0.7760552701473478, 0.7679654708585051, 0.7827479669281394, 0.7710157332023667, 0.7504034701245414, 0.7607316860686459, 0.7566822618500636, 0.754019876132598, 0.7687452470402073, 0.7667757545196938, 0.7876849594245907, 0.7842231138043466, 0.8003733858495572, 0.7986626108501526, 0.7954439536560922, 0.7994107614395158, 0.8116078153320148, 0.8061064521627671, 0.7912630322148626, 0.7959993279631026, 0.8109624279571725, 0.8012266579987685, 0.8120193818825319, 0.7941669896567104, 0.8091971371258063, 0.8054404384301591, 0.7819196727181821, 0.7859690969367643, 0.8059683841331016, 0.7953836730797811, 0.8155615321411952, 0.8252930972663481, 0.7938874060659474, 0.7889283884037009, 0.7741282888868842, 0.8028639359205275, 0.8117269691450714, 0.7808236636699356, 0.765716983688301, 0.7946166489125798, 0.7971717365124861, 0.815278661530377, 0.7958212332563326, 0.7915052621930536, 0.7550051794497366, 0.7453587990444531, 0.7801342974033214, 0.7449450137952367, 0.6970568724517129, 0.6149613782299422, 0.6007087342334902, 0.6496295573937634, 0.6315221680893089]
        else:
            bal_accuracies = [0.7264840751115261, 0.725785869903517, 0.7213061520904658, 0.7308138811079987, 0.7371983608258118, 0.7362179686689491, 0.7371983608258118, 0.7359637929245771, 0.7359637929245771, 0.7359637929245771, 0.7406976864820001, 0.7388987446830584, 0.7515898952173462, 0.7281082062454611, 0.7352173461977384, 0.7247810976242349, 0.7382347753916382, 0.7348573503475465, 0.7488328664799253, 0.7520121381886088, 0.7684848013279385, 0.7684567901234567, 0.7708818342151675, 0.7649735449735451, 0.7688873327108621, 0.7632508558979147, 0.7478861915136426, 0.7104834526403154, 0.7437887747691668, 0.7469426289034132, 0.7518767507002801, 0.7222248158522669, 0.7245175848117025, 0.7517444755680049, 0.7513564685133314, 0.771638655462185, 0.7617045336653179, 0.7656037970743853, 0.771146384479718, 0.7389034132171388, 0.7631813466127192, 0.7636533872808383, 0.7598879551820727, 0.7538634713144516, 0.7388572466023448, 0.740951862226372, 0.7347214441332088, 0.7458180309160701, 0.7553096794273266, 0.7470085071065463, 0.7464721444133209, 0.7464456893868658, 0.7550772901753294, 0.751777674032576, 0.7259311131860151, 0.6981185807656395, 0.6784583463014837, 0.6633457827575475, 0.7077440605871979, 0.7057952069716775, 0.6513206764187156, 0.587962962962963, 0.5464508766469551, 0.510652557319224]
            f1_scores = [0.7455488403902141, 0.7446713545659553, 0.7423168136570466, 0.7482046985182602, 0.7529042816954126, 0.7487423325334635, 0.7529913537218114, 0.7518846343542226, 0.7518846343542226, 0.7517660355243571, 0.7528614504318869, 0.7454993339629097, 0.7570299561084608, 0.7372539289136184, 0.7455252740441786, 0.7358822227558314, 0.7504927649318192, 0.7438830983950766, 0.7610541396233285, 0.7661484415413, 0.7783704328758617, 0.77682240567463, 0.7827764826346607, 0.7763500737218667, 0.7797633429865213, 0.7742537177472539, 0.7561999330894323, 0.7195924073925436, 0.7646354830974067, 0.7692826096648349, 0.7705559607916272, 0.7365198877315011, 0.7389856836587423, 0.7689014562469965, 0.7665969547357678, 0.7842789493229902, 0.7699823524723903, 0.777025415364782, 0.7826302795259781, 0.750994144557136, 0.7712386531854756, 0.7725710462572236, 0.7682728511174045, 0.766338601806986, 0.7499571746586258, 0.7584993748002952, 0.7473633039814139, 0.7484902477785178, 0.7514395220746851, 0.7444340947099604, 0.7459478212337263, 0.7440207910668976, 0.7474581592891506, 0.74462002073076, 0.7188192566986223, 0.6846131751596375, 0.6742686368648785, 0.6708484223502529, 0.712624717666919, 0.697445214456351, 0.6295147404838143, 0.554825577012451, 0.506761993650288, 0.47111507604816083]
    elif MODEL == "KNN":
        if BINARY:
            bal_accuracies = [0.7703635642517187, 0.7795571126388154, 0.800376784769963, 0.7770835536753041, 0.7763313061872025, 0.7695703331570597, 0.7687638815441564, 0.7736832363828663, 0.7904574299312532, 0.7904574299312532, 0.7904574299312532, 0.7720571126388155, 0.7696377578001059, 0.7736700158646219, 0.7595571126388154, 0.7820571126388154, 0.7628635642517188, 0.7936700158646219, 0.7728635642517189, 0.7836832363828663, 0.7719896879957695, 0.7844896879957695, 0.796183236382866, 0.7936832363828662, 0.7852287149656267, 0.7895703331570598, 0.7546509783183502, 0.7827961396086727, 0.7727961396086728, 0.7779706504494976, 0.76965097831835, 0.7312771020624009, 0.7187638815441565, 0.7688577472236912, 0.7662638815441565, 0.7803900052882072, 0.7463445267054468, 0.7787771020624008, 0.7679706504494976, 0.7771641988365945, 0.7463577472236912, 0.7387771020624008, 0.7554574299312533, 0.749583553675304, 0.7520835536753041, 0.7545835536753042, 0.7361964569011106, 0.7364251718667372, 0.7845029085140137, 0.7806861448968799, 0.763118720253834, 0.7294354838709678, 0.7319354838709677, 0.7687771020624009, 0.7595967741935483, 0.7363313061872026, 0.6998122686409307, 0.6938987308302484, 0.6889661554732945, 0.6604574299312532, 0.7086700158646219, 0.623253569539926, 0.5655380750925436, 0.5246641988365944]
            f1_scores = [0.7904149328850387, 0.791944979232551, 0.8120019412306455, 0.7875538501698653, 0.7812161270773827, 0.786852663531257, 0.7816844095630031, 0.787839454471313, 0.7922659002750144, 0.7922659002750144, 0.7922659002750144, 0.7820002100359587, 0.7680336480781416, 0.7944674266461055, 0.777710839935726, 0.7953562915900922, 0.7760923511063357, 0.8085656579812769, 0.7895691368206215, 0.7956072185308194, 0.7860143783797225, 0.7983064418717861, 0.8069511470557373, 0.8040939017920404, 0.8185462745881462, 0.7965870487900328, 0.7601509570516275, 0.8037285186994101, 0.7944124957022848, 0.7835001982509083, 0.7778577443960109, 0.7395826923020024, 0.7284280666193215, 0.768051886134821, 0.7812046258476408, 0.7993723282053522, 0.7552300946384874, 0.7880784121930123, 0.7777223485076808, 0.781707200514419, 0.7529852243481281, 0.7502996798615162, 0.7673155869774996, 0.7718699492409427, 0.7694052031079265, 0.7645045776324881, 0.7538409904589335, 0.731360743443526, 0.7991991456405214, 0.7658205821490354, 0.7578621982599149, 0.7639043767095453, 0.7669265989317674, 0.7743701918024662, 0.7704409685642647, 0.7346907988647859, 0.6881162083485804, 0.6912958773350738, 0.6850497233781094, 0.672365039592551, 0.7362324047369008, 0.6270700766145114, 0.5797243868484234, 0.5327708111586857]
        else:
            bal_accuracies = [0.7599315281668223, 0.7390190891171284, 0.7710400456478887, 0.769367672995124, 0.7592675588754021, 0.7596835771345576, 0.766012034443407, 0.7781771968046478, 0.7781771968046478, 0.7515821143272123, 0.7727508040253138, 0.76894128021579, 0.7589692914202718, 0.7698174084448595, 0.736904243178753, 0.7540911920323685, 0.7584370785351179, 0.7542670401493932, 0.7465862641352838, 0.7451753293910156, 0.749035169623405, 0.749140989729225, 0.7467704118684511, 0.7540792613341634, 0.7531647473804337, 0.7439910779126466, 0.7610001037452018, 0.7591513642494034, 0.7713103018985372, 0.7713824048137774, 0.7687970743853096, 0.7574784728706296, 0.7538629525884427, 0.7444112459798735, 0.7805799356779749, 0.783409067330636, 0.7563720302935988, 0.7515437286025521, 0.7525241207594149, 0.7441690009337069, 0.731617906421828, 0.7675744371822802, 0.7614000414980807, 0.7365141612200435, 0.7240849673202614, 0.7256473700591346, 0.746037970743853, 0.7224442369540409, 0.734593318809005, 0.726464363523187, 0.6983909119203237, 0.724421101774043, 0.6998532005394751, 0.6689604730781201, 0.7098729121278141, 0.6774359373378982, 0.6669535221496006, 0.6260825811806204, 0.6147883597883598, 0.6341300964830376, 0.5858341114223466, 0.5767143894594875, 0.5092286544247329, 0.4139775910364146]
            f1_scores = [0.7733065924922282, 0.7532825217778629, 0.7904255056710509, 0.7815679467298654, 0.7712223152518323, 0.7679386822165648, 0.7663975002091628, 0.7865442588957092, 0.7865876132722918, 0.7678376038592358, 0.7831464410532004, 0.7851385758266048, 0.7735367814187137, 0.7748805926194319, 0.7399232184553466, 0.7636974580267022, 0.770475291153648, 0.7670716559424126, 0.754287266915564, 0.7504034025643715, 0.7589997886525166, 0.7576162749563358, 0.7552607871076414, 0.7607478033905625, 0.7620114686595113, 0.7512549434967206, 0.763612367710583, 0.7661329684516258, 0.7815999318454534, 0.7887313548976981, 0.7829589048071839, 0.7693279535135148, 0.7676457523605436, 0.7597296111540388, 0.7954895423142689, 0.7961388076262208, 0.7749830381966463, 0.7675974691950549, 0.7686208831384691, 0.767663806778734, 0.7477413703557716, 0.7826437584937593, 0.777246525744095, 0.7500994710358235, 0.7451599169521099, 0.7322721411957059, 0.7605431525862772, 0.7373249489220162, 0.7480516636881925, 0.7428612050044366, 0.7130389703238921, 0.7342536669996378, 0.7117046692472497, 0.6867239651238103, 0.7316250193307605, 0.6920882521788807, 0.6766799599535858, 0.6357546416643302, 0.6369568152586057, 0.651973805246705, 0.6023281536342144, 0.581246300408631, 0.5220962908905434, 0.3998735170159854]
    '''
    '''
    #init_blinks, no_head
    if MODEL == "SVC":
        if BINARY:
            bal_accuracies = [0.6604706504494976, 0.6645029085140137, 0.7278900052882074, 0.6978900052882073, 0.6962771020624009, 0.6854706504494976, 0.6862771020624008, 0.6854706504494976, 0.7270835536753042, 0.7270835536753042, 0.7211158117398202, 0.7386964569011105, 0.7286964569011105, 0.7111832363828663, 0.6994896879957695, 0.6886832363828663, 0.719583553675304, 0.7195029085140138, 0.7211832363828663, 0.7003767847699629, 0.719583553675304, 0.7147316234796404, 0.6974471179270227, 0.687392913802221, 0.7155380750925435, 0.6822051824431518, 0.6822051824431519, 0.6746377578001058, 0.7014793759915389, 0.6890058170280275, 0.700618720253834, 0.6949735589635113, 0.7134148598625066, 0.7450013220518246, 0.7459016393442622, 0.7369500264410365, 0.7269090428344791, 0.7503913273400317, 0.7344235854045478, 0.7074471179270229, 0.7193693812797463, 0.6864000528820731, 0.6637123215230037, 0.6159955050237971, 0.6254177683765204, 0.6294500264410364, 0.592741935483871, 0.6021113167636172, 0.6607152300370175]
            f1_scores = [0.6733241505711511, 0.6891244236129811, 0.7368256390688384, 0.709949301030448, 0.7034094136776574, 0.6985090125445627, 0.7024866403410881, 0.699845063280156, 0.7353680390107812, 0.7340319882751876, 0.74021226180427, 0.7498436627056438, 0.7387422802171646, 0.7275585139218684, 0.7196545263105637, 0.7045688120248494, 0.7278448550219783, 0.73654003578317, 0.7328124615259017, 0.7129609484135067, 0.7164392155272035, 0.7021224137064644, 0.6769754995578446, 0.6716106185824333, 0.7078322577919183, 0.6847904385797408, 0.6862302048433233, 0.6862248224045782, 0.6900503506051759, 0.6759389380962141, 0.6890695713572204, 0.6705961815984024, 0.687275013512836, 0.708424987525759, 0.7006055204892995, 0.6840984525936304, 0.6803216182291474, 0.6915746989592125, 0.6854974072107652, 0.6906897817415163, 0.6826040671448707, 0.642606789369996, 0.6274537937584752, 0.6009196779781475, 0.5985288290084252, 0.6115407389288627, 0.5910983173421552, 0.5691101996392854, 0.5583910167030508]
        else:
            bal_accuracies = [0.7213092644465193, 0.7261152609191825, 0.7368456271397448, 0.7390164954870838, 0.7299128540305012, 0.7270676418715635, 0.736591451395373, 0.7277098246706089, 0.7312475360514575, 0.724840751115261, 0.721917730054985, 0.7199450150430543, 0.7211474219317356, 0.7255871978420998, 0.7287384583463015, 0.7189324618736384, 0.7128540305010892, 0.6913575059653491, 0.7066075319016495, 0.7172279282083203, 0.7069996887643946, 0.6831740844485943, 0.689414358335927, 0.7062413113393505, 0.7318793443303248, 0.7187062973337482, 0.7157448905488121, 0.694680464778504, 0.7091762630978318, 0.6991160908807968, 0.6871713870733478, 0.6946903205726735, 0.6910571636061832, 0.6889423176678078, 0.6928960473078121, 0.7146291109036207, 0.7246010996991389, 0.7359975101151571, 0.742624234879137, 0.7365074177819275, 0.6887882560431581, 0.697217553688142, 0.7082415188297542, 0.705592903828198, 0.686365286855483, 0.7097603485838779, 0.6501716983089533, 0.5409487498703186, 0.510652557319224]
            f1_scores = [0.7371832654163674, 0.739049370816198, 0.7498792546050966, 0.7511782967404612, 0.74300867608594, 0.7494600505306491, 0.7565123401269699, 0.7454272509177801, 0.7486739044432584, 0.7402743570019618, 0.7406471031026316, 0.7355229918747063, 0.7407913307418241, 0.7390764285581886, 0.7422858381701118, 0.73297259542352, 0.7289586398917025, 0.7097024564589414, 0.7235498367748454, 0.730606734854806, 0.7186573183717069, 0.6921063382119922, 0.6950469500797701, 0.7193858311940888, 0.7363084254087056, 0.7291556004876394, 0.7207126807574358, 0.7045222903607178, 0.7149338989846886, 0.7026231229575097, 0.6903818675683184, 0.6913755655582525, 0.7018747681836975, 0.6964602531909023, 0.6970275653837545, 0.7283183053353144, 0.7296673024158682, 0.7385629672442426, 0.728880107958488, 0.722743097339121, 0.6724356607116653, 0.6965931399803843, 0.6978404963050707, 0.6894470926190946, 0.6710437325379657, 0.6784579422503192, 0.6177917831911894, 0.49815613917402574, 0.47111507604816083]
    elif MODEL == "KNN":
        if BINARY:
            bal_accuracies = [0.8045029085140138, 0.7845029085140138, 0.7712506610259122, 0.729583553675304, 0.7728093601269169, 0.7710893707033316, 0.8128635642517187, 0.7694764674775252, 0.7695571126388154, 0.7419896879957694, 0.7519896879957694, 0.750376784769963, 0.7854574299312533, 0.8062638815441566, 0.7986832363828661, 0.7986832363828661, 0.7794896879957695, 0.7794896879957693, 0.7737506610259123, 0.7961832363828661, 0.8253767847699631, 0.8494896879957695, 0.8394896879957695, 0.8078093601269171, 0.8212771020624009, 0.827218402961396, 0.8312638815441566, 0.7755922792173454, 0.7189661554732946, 0.7663987308302487, 0.7872184029613962, 0.7796377578001058, 0.7688445267054468, 0.7656187202538339, 0.7680380750925436, 0.7988313061872026, 0.7471377578001058, 0.7579442094130091, 0.7087506610259122, 0.6646509783183501, 0.7246377578001058, 0.7190190375462718, 0.7664516129032257, 0.685444209413009, 0.6713313061872025, 0.6472316234796404, 0.7039251718667371, 0.5523664727657325, 0.5672448439978848]
            f1_scores = [0.8126791255871579, 0.7928889485394224, 0.771458307761112, 0.7412899710447352, 0.791080480275254, 0.7923917433335367, 0.8189561146988658, 0.7922375903161958, 0.7826325084761022, 0.7563661223958433, 0.7640256841820771, 0.758969838328005, 0.7759026971304908, 0.7973673017648275, 0.8015231337276457, 0.8024031184416718, 0.7888382076125003, 0.7879915860193796, 0.7739576755487496, 0.7999799520465447, 0.8220400175549065, 0.8487518955801387, 0.8380468288354332, 0.8231159688602274, 0.8172718908951081, 0.8114106479205008, 0.8240890858864967, 0.7549258394712837, 0.705640871122988, 0.7514040783266605, 0.7675424181841513, 0.7652868214758307, 0.7570574029627443, 0.7444257486909988, 0.7587279826353104, 0.788417007689221, 0.7474823410679295, 0.752650573302289, 0.7179142176548166, 0.6713667712373875, 0.7226867883635066, 0.7087898541589917, 0.7519225276828667, 0.6878382423416415, 0.686175625687676, 0.657338163315446, 0.7083445261333132, 0.5490072457065055, 0.5640212863005486]
        else:
            bal_accuracies = [0.7350710654632223, 0.7363336445689387, 0.7304092748210396, 0.7265437286025521, 0.7269758273679842, 0.7323140367258014, 0.6898329702251271, 0.6886585745409274, 0.7096550472040668, 0.7144211017740429, 0.709255109451188, 0.7192229484386348, 0.7036186326382405, 0.7447593111318601, 0.7312558356676003, 0.733148666874157, 0.7286248573503474, 0.7183006535947712, 0.7209197012138189, 0.7072642390289449, 0.7199112978524742, 0.7267320261437907, 0.7385869903516962, 0.7219581906836808, 0.7226065981948334, 0.7180724141508454, 0.7502313517999792, 0.7242789708475984, 0.7158413735864716, 0.7008973959954352, 0.6944610436767299, 0.6832384064737005, 0.6798329702251271, 0.6853869696026559, 0.6510514576200851, 0.6655576304595913, 0.628560535325241, 0.6578343189127503, 0.6278898225957049, 0.6438318290279075, 0.5843837535014005, 0.5715162361240791, 0.5982378877476917, 0.6270090258325552, 0.5851691046789086, 0.5788883701628799, 0.5832477435418613, 0.49112771034339653, 0.40595238095238095]
            f1_scores = [0.7442307980386187, 0.7454265914874363, 0.7337908834837625, 0.7273857986681633, 0.7278198259004285, 0.7361645155298038, 0.7018523253906127, 0.697916130769039, 0.7198876816682943, 0.7246244152969535, 0.713495413645061, 0.7180082685182021, 0.7111113850820681, 0.7520608282393876, 0.7329130975933856, 0.7407490268318788, 0.7378639225640202, 0.7383657534878176, 0.7333216245637572, 0.7207592338290846, 0.7408936136753432, 0.7375236713368152, 0.7487301319622313, 0.7372056515498934, 0.7356246853901425, 0.7292235241675994, 0.7601461385096835, 0.7343438828349067, 0.723137538423149, 0.7100003041409161, 0.7107518914935398, 0.6966892241800221, 0.6922245705754972, 0.6922113402100841, 0.6702981163054018, 0.6864630375772183, 0.6494908557988536, 0.6777363357900053, 0.6438236758597461, 0.6533382751543366, 0.6072366554928716, 0.5778838863265043, 0.6104444800582123, 0.62838324156904, 0.5871989448040489, 0.5883708265453109, 0.5791718817739456, 0.4955678341253509, 0.40135634831362543]
    '''

    '''
    #init_blinks, left/right orig. + left/right diff.
    if MODEL == "SVC":
        if BINARY:
            bal_accuracies = []
            f1_scores = []
        else:
            bal_accuracies = []
            f1_scores = []
    elif MODEL == "KNN":
        if BINARY:
            bal_accuracies = [0.7944222633527234, 0.7735893707033317, 0.7836025912215759, 0.7736158117398203, 0.7936158117398202, 0.8052287149656268, 0.7736158117398203, 0.7711964569011107, 0.772809360126917, 0.7719896879957695, 0.780376784769963, 0.7744090428344791, 0.7752154944473822, 0.7811832363828662, 0.7860351665785299, 0.785309360126917, 0.7844222633527235, 0.7777287149656267, 0.7928093601269169, 0.8045029085140138, 0.8028900052882074, 0.7803900052882072, 0.7803900052882072, 0.7211832363828663, 0.7311832363828662, 0.7311964569011105, 0.7703900052882073, 0.7479706504494976, 0.8028900052882072, 0.8028900052882074, 0.7853093601269169, 0.7912638815441565, 0.8012771020624008, 0.7911964569011106, 0.792809360126917, 0.8061158117398202, 0.8020029085140138, 0.792809360126917, 0.7820029085140138, 0.792809360126917, 0.7936964569011106, 0.792083553675304, 0.7904032258064515, 0.782016129032258, 0.7753225806451614, 0.7661290322580646, 0.762016129032258, 0.7604032258064517, 0.7704032258064516, 0.7887771020624009, 0.7663709677419355, 0.7663709677419355, 0.7663709677419355, 0.7571774193548386, 0.7270967741935485, 0.7546774193548387, 0.792258064516129, 0.8047316234796404, 0.7763445267054468, 0.7647316234796404, 0.7679032258064515, 0.755483870967742, 0.7498387096774194, 0.733051295610788, 0.7122448439978848, 0.7246774193548388, 0.7137903225806452, 0.6620967741935483, 0.6295835536753039, 0.6756319407720783, 0.7188577472236911, 0.6832800105764146, 0.6712903225806452, 0.5874867794817556, 0.4965600211528292]
            f1_scores = [0.8220295434916354, 0.8011261019729797, 0.8073727582311114, 0.7964436437120446, 0.8180458262517272, 0.8279865352367175, 0.7964436437120446, 0.7822277584393966, 0.7929278979595222, 0.7912979372504129, 0.787320664678002, 0.804051492797343, 0.8113963231234032, 0.7921378624529877, 0.8181924030596239, 0.7977554510012494, 0.8097295852486113, 0.8017051804867066, 0.8105489611269924, 0.8160852093005342, 0.8097509589909034, 0.7904347043035054, 0.793949211353969, 0.7405570853879886, 0.7460849653570012, 0.7447026329852904, 0.7841434494391162, 0.7566656210100435, 0.8120806338668245, 0.8122281404898357, 0.8026280688624438, 0.7935211066623018, 0.8014218911104273, 0.8027854616883404, 0.8125518738015197, 0.827637588087234, 0.8156277570580481, 0.81314726925317, 0.7949845924169655, 0.8068957035280766, 0.8007851930369325, 0.7945668485076867, 0.8008265766427967, 0.7959391941703827, 0.7926222777502814, 0.7890637524046592, 0.7870265431660187, 0.7707344803938112, 0.7806268186239608, 0.7913153681486955, 0.767919997498262, 0.767919997498262, 0.767919997498262, 0.7661041676077798, 0.7446926273684481, 0.7599803548219148, 0.7840435895663911, 0.7924375886094093, 0.7742664556800358, 0.7548666919774536, 0.7750676416487462, 0.763552021585119, 0.7435324921370341, 0.7342496152882311, 0.7126782477709058, 0.7313293416833387, 0.7285100558878692, 0.6832011858490622, 0.6388165543845862, 0.6813759656101116, 0.7198856607969223, 0.6732863377263505, 0.6898290590473767, 0.5900260995202165, 0.49028072255934746]
        else:
            bal_accuracies = []
            f1_scores = []
    '''

    print(len(f1_scores))
    
    bal_accuracies = bal_accuracies[::-1]
    y = np.array(bal_accuracies)
    f1_scores = f1_scores[::-1]
    y_ = np.array(f1_scores)
    x = np.array(range(1, len(y)+1))
        
    elbow_point_idx = find_elbow_point(x, y)
    elbow_point_num = elbow_point_idx + 1
    elbow_point_acc = y[elbow_point_idx]
    corr_f1 = y_[elbow_point_idx]
    #print(f"The elbow point for bal.accuracy is at {elbow_point_num} features.")
    #print(f"Bal.accuracy at the elbow point: {elbow_point_acc:.2f}")
    #print(f"Corresponding F1-score: {corr_f1:.2f}")
        
    elbow_point_f1_idx = find_elbow_point(x, y_)
    elbow_point_f1_num = elbow_point_f1_idx + 1
    elbow_point_f1 = y_[elbow_point_f1_idx]
    corr_acc = y[elbow_point_f1_idx]
    print(f"The elbow point for F1-score is at {elbow_point_f1_num} features.")
    print(f"F1-score at the elbow point: {elbow_point_f1:.4f}")
    #print(f"Corresponding bal.accuracy: {corr_acc:.2f}")
        
    filename = "chs"
    if BINARY:
        filename = filename + "_binary_"
    else:
        filename = filename + "_3classes_"
    filename = filename + MODEL
            
    # Plot accuracies
    fig0, ax0 = plt.subplots()
    ax0.plot(x, y, marker='o')
            
    ax0.set_xlabel('Number of Features', fontsize=14)
    ax0.set_ylabel('Balanced accuracy', fontsize=14)
    ax0.tick_params(axis='both', which='major', labelsize=12)
    ax0.tick_params(axis='both', which='minor', labelsize=10)
    plt.grid(True)
    acc_filename = filename + "_bal_acc.png"
    full_filename = os.path.join(FIG_DIR, acc_filename)
    #plt.gca().set_aspect('equal', adjustable='box')
    plt.savefig(full_filename, dpi=600)
    plt.show()
            
    # Plot F1-scores
    fig2, ax2 = plt.subplots()
    ax2.plot(x, y_, marker='o')
    ax2.set_xlabel('Number of features', fontsize=14)
    ax2.set_ylabel('f1 score', fontsize=14)
    ax2.tick_params(axis='both', which='major', labelsize=12)
    ax2.tick_params(axis='both', which='minor', labelsize=10)
    plt.grid(True)
    f1_filename = filename + "_f1.png"
    full_filename = os.path.join(FIG_DIR, f1_filename)
    #plt.tight_layout()
    plt.savefig(full_filename, dpi=600)
    plt.show()
    
    
        
    max_acc = max(bal_accuracies)
    max_index = bal_accuracies.index(max_acc)
    #print(f"Max_index: {max_index}")
    number_of_features = max_index + 1
    acc = bal_accuracies[max_index]
    f1 = f1_scores[max_index]
    #print("Optimal number of features by maximizing Bal.Accuracy")
    #print(f"Optimal number of features: {number_of_features}, Bal.Accuracy: {acc:.2f}, F1-score: {f1:.2f}")

    max_f1 = max(f1_scores)
    max_index = f1_scores.index(max_f1)
    #print(f"Max_index: {max_index}")
    number_of_features = max_index + 1
    acc = bal_accuracies[max_index]
    f1 = f1_scores[max_index]
    print("Optimal number of features by maximizing F1-score")
    #print(f"Optimal number of features: {number_of_features}, Bal.Accuracy: {acc:.2f}, F1-score: {f1:.2f}")
    print(f"Optimal number of features: {number_of_features}, F1-score: {f1:.4f}")
    
    if SAVE_COORD:
       
        filename = 'curve_coordinates.csv'
        with open(filename, mode='w', newline='') as file:
            writer = csv.writer(file)
            writer.writerow(['x', 'y'])  # Write the header
            for i in range(len(x)):
                writer.writerow([x[i], y_[i]])
##############        

start_time = time.time()

main()

elapsed_time = time.time() - start_time
print(f"Elapsed time: {elapsed_time:.3f} seconds")
    